var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},s=e.parcelRequire0c93;null==s&&((s=function(e){if(e in t)return t[e].exports;if(e in n){var s=n[e];delete n[e];var o={id:e,exports:{}};return t[e]=o,s.call(o.exports,o,o.exports),o.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){n[e]=t},e.parcelRequire0c93=s);var o=s("6AR8M"),a=s("gdelx"),i=s("k8Jq9");i=s("k8Jq9"),i=s("k8Jq9"),i=s("k8Jq9"),i=s("k8Jq9");window.addEventListener("load",(()=>{const e=(0,o.getAuth)();(0,o.onAuthStateChanged)(e,(e=>{if(e){const t=e.uid,n=(0,a.getDatabase)(),s=(0,a.ref)(n,`users/${t}`);(0,a.onValue)(s,(e=>{const t=e.val(),n=document.getElementById("username"),s=document.querySelector(".logout-container p"),o=document.getElementById("profileImage");s&&(s.innerHTML=t.username),n&&(n.innerText=t.username),o&&(o.src=t.image)})),c(),l(),(0,i.fetchUsers)().then((e=>{Object.entries(e).forEach((([e,t])=>{const n=document.querySelector(".user-names"),s=document.createElement("p");s.setAttribute("data-user-id",e),n?.append(s),s&&(s.innerText=t.username),s.addEventListener("click",(()=>{window.location.href=`./profile.html?userId=${e}`}))}))}))}else console.log("No user is signed in")}))})),document.getElementById("postBtn")?.addEventListener("click",(async e=>{e.preventDefault();const t=(0,o.getAuth)().currentUser;if(t){const e=t.uid,n=document.getElementById("postContent"),s=n.value;s?(await(0,i.createPost)(e,s),n.value=""):console.log("No content provided")}else console.log("No user is signed in")}));const c=e=>{const t=(0,a.getDatabase)(),n=(0,a.ref)(t,"posts");(0,a.onValue)(n,(async e=>{const n=e.val(),s=document.getElementById("postsList");if(n&&s){s.innerHTML="";const e=Object.entries(n).map((([e,t])=>({id:e,userId:t.userId,content:t.content,createdAt:t.createdAt,likes:t.likes})));e.sort(((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()));for(const n of e){const e=(await(0,a.get)((0,a.ref)(t,`users/${n.userId}`))).val();if(e){const t=document.createElement("div");t.className="post-item",t.innerHTML=`\n            <h5 class="postName">${e.username}</h5>\n            <p class="postContent">${n.content}</p>\n            <p class="postTime">${n.createdAt}</p>\n            <div class="post-actions">\n            <a class="like-btn" data-post-id="${n.id}"><i class="far fa-heart"></i> ${n.likes}</a>\n              <a class="reply-btn"><i class="far fa-comment"></i></a>\n            </div>\n          `,s.appendChild(t);const o=t.querySelector(".like-btn");o&&o.addEventListener("click",(e=>{e.preventDefault(),r(e,n.id,n.userId)}))}}}}))};async function r(e,t,n){e.preventDefault();const s=(0,a.getDatabase)(),o=(await(0,a.get)((0,a.ref)(s,`posts/${t}`))).val();if(o){const n=o.likes+1;await(0,i.updateLikes)(t,n);e.target.textContent=` Likes: ${n}`}else console.error(`Unable to find post data for post ID: ${t}`)}const l=async()=>{const e=(0,a.getDatabase)(),t=(0,a.ref)(e,"posts"),n=(await(0,a.get)(t)).val(),s=Object.entries(n).map((([e,t])=>({id:e,userId:t.userId,content:t.content,createdAt:t.createdAt,likes:t.likes})));console.log("postarr:"+s),s.sort(((e,t)=>t.likes-e.likes));const o=s.slice(0,5),i=document.getElementById("top10LikedPosts");if(i){i.innerHTML="";for(const t of o){const n=(await(0,a.get)((0,a.ref)(e,`users/${t.userId}`))).val();if(n){const e=document.createElement("div");e.className="postLiked10",e.innerHTML=`\n          <h5 class="postNameLiked">${n.username}</h5>\n          <p class="postContentLiked">${t.content}</p>\n          <p class="postLikesLiked">Likes: ${t.likes}</p>\n        `,i.appendChild(e)}}}};document.querySelector("#loggOutBtn").addEventListener("click",(()=>{(0,i.logOutAccount)().then((()=>{location.assign("../index.html")}))}));document.querySelector("#deleteAccountBtn").addEventListener("click",(()=>{(0,i.deleteAccount)().then((()=>{location.assign("../index.html")}))}));
//# sourceMappingURL=mainpage.e227324e.js.map
