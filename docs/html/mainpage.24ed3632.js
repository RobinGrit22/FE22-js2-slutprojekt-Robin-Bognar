function e(e,t,n,o){Object.defineProperty(e,t,{get:n,set:o,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},o={},s=t.parcelRequire6776;null==s&&((s=function(e){if(e in n)return n[e].exports;if(e in o){var t=o[e];delete o[e];var s={id:e,exports:{}};return n[e]=s,t.call(s.exports,s,s.exports),s.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},t.parcelRequire6776=s),s.register("27Lyk",(function(t,n){var o,s;e(t.exports,"register",(()=>o),(e=>o=e)),e(t.exports,"resolve",(()=>s),(e=>s=e));var r={};o=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)r[t[n]]=e[t[n]]},s=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),s("27Lyk").register(JSON.parse('{"eqpYo":"mainpage.24ed3632.js","5krED":"unicorn.9741a3c2.jpg","erfBi":"unicorn2.07a228f2.png","7ee9c":"unicorn3.702da4bf.png","b0Obp":"unicorn4.2a835587.png","3Iiwf":"profile.68ebbba3.js"}'));var r,a=s("6AR8M"),i=s("gdelx"),c=s("k8Jq9");c=s("k8Jq9"),c=s("k8Jq9"),c=s("k8Jq9"),c=s("k8Jq9");r=new URL("../"+s("27Lyk").resolve("5krED"),import.meta.url).toString();var l;l=new URL("../"+s("27Lyk").resolve("erfBi"),import.meta.url).toString();var d;d=new URL("../"+s("27Lyk").resolve("7ee9c"),import.meta.url).toString();var u;u=new URL("../"+s("27Lyk").resolve("b0Obp"),import.meta.url).toString();window.addEventListener("load",(()=>{console.log("main function called");const e=(0,a.getAuth)();(0,a.onAuthStateChanged)(e,(e=>{if(console.log("auth state changed",e),e){const t=e.uid,n=(0,i.getDatabase)(),o=(0,i.ref)(n,`users/${t}`);(0,i.onValue)(o,(e=>{const t=e.val();console.log("userData:",t);const n=document.getElementById("username"),o=document.querySelector(".logout-container p"),s=document.getElementById("profileImage");if(o&&(o.innerHTML=t.username),n&&(n.innerText=t.username),s){if("../image/unicorn.jpg"===t.image){const e=new URL(r);s.src=e.href}if("../image/unicorn2.png"===t.image){const e=new URL(l);s.src=e.href}if("../image/unicorn3.png"===t.image){const e=new URL(d);s.src=e.href}if("../image/unicorn4.png"===t.image){const e=new URL(u);s.src=e.href}}})),p(),g(),(0,c.fetchUsers)().then((e=>{console.log("users:",e),console.log(Object.values(e)),Object.entries(e).forEach((([e,t])=>{const n=document.querySelector(".user-names"),o=document.createElement("p");o.setAttribute("data-user-id",e),n?.append(o),o&&(o.innerText=t.username),o.addEventListener("click",(()=>{window.location.href=`./profile.html?userId=${e}`}))}))}))}else console.log("No user is signed in")}))})),document.getElementById("postBtn")?.addEventListener("click",(async e=>{e.preventDefault();const t=(0,a.getAuth)().currentUser;if(t){const e=t.uid,n=document.getElementById("postContent"),o=n.value;o?(await(0,c.createPost)(e,o),n.value=""):console.log("No content provided")}else console.log("No user is signed in")}));const p=()=>{const e=(0,i.getDatabase)(),t=(0,i.ref)(e,"posts");(0,i.onValue)(t,(async t=>{const n=t.val(),o=document.getElementById("postsList");if(n&&o){o.innerHTML="";const t=Object.entries(n).map((([e,t])=>({id:e,userId:t.userId,content:t.content,createdAt:t.createdAt,likes:t.likes})));t.sort(((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()));for(const n of t){const t=(await(0,i.get)((0,i.ref)(e,`users/${n.userId}`))).val(),s=document.createElement("div");s.className="post-item",s.innerHTML=`\n          <h5 class="postName">${t.username}</h5>\n          <p class="postContent">${n.content}</p>\n          <p class="postTime">${n.createdAt}</p>\n          <div class="post-actions">\n          <a class="like-btn" data-post-id="${n.id}"><i class="far fa-heart"></i> ${n.likes}</a>\n            <a class="reply-btn"><i class="far fa-comment"></i></a>\n          </div>\n        `,o.appendChild(s);const r=s.querySelector(".like-btn");r&&r.addEventListener("click",(e=>{e.preventDefault(),f(e,n.id,n.userId)}))}}}))};async function f(e,t,n){e.preventDefault();const o=(0,i.getDatabase)(),s=(await(0,i.get)((0,i.ref)(o,`posts/${t}`))).val();if(s){const n=s.likes+1;await(0,c.updateLikes)(t,n);e.target.textContent=` Likes: ${n}`}else console.error(`Unable to find post data for post ID: ${t}`)}const g=async()=>{const e=(0,i.getDatabase)(),t=(0,i.ref)(e,"posts"),n=(await(0,i.get)(t)).val(),o=Object.entries(n).map((([e,t])=>({id:e,userId:t.userId,content:t.content,createdAt:t.createdAt,likes:t.likes})));o.sort(((e,t)=>t.likes-e.likes));const s=o.slice(0,5),r=document.getElementById("top10LikedPosts");if(r){r.innerHTML="";for(const t of s){const n=(await(0,i.get)((0,i.ref)(e,`users/${t.userId}`))).val(),o=document.createElement("div");o.className="postLiked10",o.innerHTML=`\n        <h5 class="postNameLiked">${n.username}</h5>\n        <p class="postContentLiked">${t.content}</p>\n        <p class="postLikesLiked">Likes: ${t.likes}</p>\n      `,r.appendChild(o)}}};document.querySelector("#loggOutBtn").addEventListener("click",(()=>{(0,c.logOutAccount)().then((()=>{location.assign("../index.html")}))}));document.querySelector("#deleteAccountBtn").addEventListener("click",(()=>{(0,c.deleteAccount)().then((()=>{location.assign("../index.html")}))}));
//# sourceMappingURL=mainpage.24ed3632.js.map
